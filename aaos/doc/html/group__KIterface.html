<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Double A O.S.: Kernel interface</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<h1>Kernel interface</h1>abc.  
<a href="#_details">More...</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ge25aa2afb1e11b31db30ad6085a89a50"></a><!-- doxytag: member="KIterface::CREATENOGOOD" ref="ge25aa2afb1e11b31db30ad6085a89a50" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#ge25aa2afb1e11b31db30ad6085a89a50">CREATENOGOOD</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicate that thread creation went wrong. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gb4f83fc3595f0fdb21f4a7ca5ce58fb6"></a><!-- doxytag: member="KIterface::MSGNOGOOD" ref="gb4f83fc3595f0fdb21f4a7ca5ce58fb6" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#gb4f83fc3595f0fdb21f4a7ca5ce58fb6">MSGNOGOOD</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indicate that message passing went wrong. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="gd53eb5b21afa5c70f498ade4c07a857d"></a><!-- doxytag: member="KIterface::SSI_MAGICNO" ref="gd53eb5b21afa5c70f498ade4c07a857d" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#gd53eb5b21afa5c70f498ade4c07a857d">SSI_MAGICNO</a>&nbsp;&nbsp;&nbsp;0x0FFFFFFF</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Magic number (it points to bad address in memory) for sending/receiving messages to/from System Service Thread. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="g64862cd049758be4910ae78170276fbe"></a><!-- doxytag: member="KIterface::ANYMESSAGE" ref="g64862cd049758be4910ae78170276fbe" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g64862cd049758be4910ae78170276fbe">ANYMESSAGE</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For receiving messages from any sender. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g1974bb5cafbaefdc648db97e7ffcc1cb">msg_send</a>(dest, payload)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a message to a thread.  <a href="#g1974bb5cafbaefdc648db97e7ffcc1cb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g2b4836bdc10d3673bcd9bd9f9fc5bef4">msg_recv</a>(source, reply)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive a message from a thread.  <a href="#g2b4836bdc10d3673bcd9bd9f9fc5bef4"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#gac232a6efd6fe7eba766fd27c652b5cc">SyscallMsg</a> { <a class="el" href="group__KIterface.html#ggac232a6efd6fe7eba766fd27c652b5cc67be7a5f47004345047b32fff72a2230">SEND</a> =  1, 
<a class="el" href="group__KIterface.html#ggac232a6efd6fe7eba766fd27c652b5cc586011d90be069a5203e7bdbcb760302">RECV</a> =  2
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Syscall mnemonic values.  <a href="group__KIterface.html#gac232a6efd6fe7eba766fd27c652b5cc">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g1cbceddebd8723dff49458ce4045853f">ServiceRequest</a> { <br>
&nbsp;&nbsp;<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853fdc448ce3eefa10077844832a6af19ffa">CREATEBROTHER</a> =  1, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853f71072182f5e358131f6b9eb659635291">CREATESON</a>, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853f9aab2d9eae3e9a84d9fed3f0cadd7e22">TERMINATE</a>, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853ff7d985b96f94d78997dc93747b605c31">SPECPRGMGR</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853f94f526c79690438b6c57415636b2885e">SPECTLBMGR</a>, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853fddb28cb337be3010f1522cf3ef899265">SPECSYSMGR</a>, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853f1a09fd64037cfe9801ad4f61ccaeca16">GETCPUTIME</a>, 
<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853fe54320fe119bc3ed036cc9a4635a40d4">WAITFORCLOCK</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="group__KIterface.html#gg1cbceddebd8723dff49458ce4045853f1e3a5237609db55456ad8b411e3b9f2c">WAITFORIO</a>
<br>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Service request values.  <a href="group__KIterface.html#g1cbceddebd8723dff49458ce4045853f">More...</a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g570c4ee4b7e9b06de25acaad56cdb1e6">TrapCommand</a> { <a class="el" href="group__KIterface.html#gg570c4ee4b7e9b06de25acaad56cdb1e6def07312c4771960b414a7978d978cef">TRAPTERMINATE</a>, 
<a class="el" href="group__KIterface.html#gg570c4ee4b7e9b06de25acaad56cdb1e664b0325ae5a701a1c601d92c357ff52c">TRAPCONTINUE</a>
 }</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Commands for the SYSCALL/TLB/TRAP manager.  <a href="group__KIterface.html#g570c4ee4b7e9b06de25acaad56cdb1e6">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__KIterface.html#g755e2ed4fdb9bfc9d54c5a28de5a94b6">SSIRequest</a> (unsigned service, unsigned payload, unsigned *reply)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Perform a System Service request.  <a href="#g755e2ed4fdb9bfc9d54c5a28de5a94b6"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
abc. 
<p>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="g2b4836bdc10d3673bcd9bd9f9fc5bef4"></a><!-- doxytag: member="kernel.h::msg_recv" ref="g2b4836bdc10d3673bcd9bd9f9fc5bef4" args="(source, reply)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_recv          </td>
          <td>(</td>
          <td class="paramtype">source,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">reply&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Receive a message from a thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td>Source thread. ANYMESSAGE for receiving from all threads. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reply</em>&nbsp;</td><td>Pointer to the reply. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>A pointer to the TCB of the sender. </dd></dl>

</div>
</div><p>
<a class="anchor" name="g1974bb5cafbaefdc648db97e7ffcc1cb"></a><!-- doxytag: member="kernel.h::msg_send" ref="g1974bb5cafbaefdc648db97e7ffcc1cb" args="(dest, payload)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_send          </td>
          <td>(</td>
          <td class="paramtype">dest,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">payload&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Send a message to a thread. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dest</em>&nbsp;</td><td>Destination thread. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>payload</em>&nbsp;</td><td>Content of the message. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="g1cbceddebd8723dff49458ce4045853f"></a><!-- doxytag: member="kernel.h::ServiceRequest" ref="g1cbceddebd8723dff49458ce4045853f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__KIterface.html#g1cbceddebd8723dff49458ce4045853f">ServiceRequest</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Service request values. 
<p>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group__KIterface.html#g755e2ed4fdb9bfc9d54c5a28de5a94b6">SSIRequest</a> </dd></dl>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853fdc448ce3eefa10077844832a6af19ffa"></a><!-- doxytag: member="CREATEBROTHER" ref="gg1cbceddebd8723dff49458ce4045853fdc448ce3eefa10077844832a6af19ffa" args="" -->CREATEBROTHER</em>&nbsp;</td><td>
Create a new thread whose initial processor state is passed by reference as service request <em>payload</em> as brother of the caller. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853f71072182f5e358131f6b9eb659635291"></a><!-- doxytag: member="CREATESON" ref="gg1cbceddebd8723dff49458ce4045853f71072182f5e358131f6b9eb659635291" args="" -->CREATESON</em>&nbsp;</td><td>
Create a new thread whose initial processor state is passed by reference as service request <em>payload</em> as son of the caller. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853f9aab2d9eae3e9a84d9fed3f0cadd7e22"></a><!-- doxytag: member="TERMINATE" ref="gg1cbceddebd8723dff49458ce4045853f9aab2d9eae3e9a84d9fed3f0cadd7e22" args="" -->TERMINATE</em>&nbsp;</td><td>
Terminate the caller thread and all of its progeny in a recursive way. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853ff7d985b96f94d78997dc93747b605c31"></a><!-- doxytag: member="SPECPRGMGR" ref="gg1cbceddebd8723dff49458ce4045853ff7d985b96f94d78997dc93747b605c31" args="" -->SPECPRGMGR</em>&nbsp;</td><td>
This request allows a thread to specify his own trap management thread for Program Trap exceptions. 
<p>
The trap management thread address is passed as service request <em>payload</em>; if the management thread does not exist, the requestor thread and its progeny will be terminated. Once assigned or inherited, the trap management thread cannot be redefined: further service requests of this type will cause the termination of the thread and its progeny. The field <em>reply</em> is not used. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853f94f526c79690438b6c57415636b2885e"></a><!-- doxytag: member="SPECTLBMGR" ref="gg1cbceddebd8723dff49458ce4045853f94f526c79690438b6c57415636b2885e" args="" -->SPECTLBMGR</em>&nbsp;</td><td>
This request allows a thread to specify his own trap management thread for TLB Management exceptions. 
<p>
The trap management thread address is passed as service request <em>payload</em>; if the management thread does not exist, the requestor thread and its progeny will be terminated. Once assigned or inherited, the trap management thread cannot be redefined: further service requests of this type will cause the termination of the thread and its progeny. The field <em>reply</em> is not used. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853fddb28cb337be3010f1522cf3ef899265"></a><!-- doxytag: member="SPECSYSMGR" ref="gg1cbceddebd8723dff49458ce4045853fddb28cb337be3010f1522cf3ef899265" args="" -->SPECSYSMGR</em>&nbsp;</td><td>
This request allows a thread to specify his own trap management thread for SYSCALL/BREAK exceptions. 
<p>
The trap management thread address is passed as service request <em>payload</em>; if the management thread does not exist, the requestor thread and its progeny will be terminated. Once assigned or inherited, the trap management thread cannot be redefined: further service requests of this type will cause the termination of the thread and its progeny. This trap management thread will be called when "pass up" of SYSCALLs and service requests is attempted. The field <em>reply</em> is not used. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853f1a09fd64037cfe9801ad4f61ccaeca16"></a><!-- doxytag: member="GETCPUTIME" ref="gg1cbceddebd8723dff49458ce4045853f1a09fd64037cfe9801ad4f61ccaeca16" args="" -->GETCPUTIME</em>&nbsp;</td><td>
Return the CPU time (in microseconds) used by the requesting thread. 
<p>
The field <em>payload</em> is not used. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853fe54320fe119bc3ed036cc9a4635a40d4"></a><!-- doxytag: member="WAITFORCLOCK" ref="gg1cbceddebd8723dff49458ce4045853fe54320fe119bc3ed036cc9a4635a40d4" args="" -->WAITFORCLOCK</em>&nbsp;</td><td>
The nucleus mantains a pseudo-clock (a pseudo-device which raise an interrupt every 100 milliseconds). 
<p>
Upon request, the requesting thread is blocked until the next pseudo-clock tick. The fields <em>payload</em> and <em>reply</em> are not used. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg1cbceddebd8723dff49458ce4045853f1e3a5237609db55456ad8b411e3b9f2c"></a><!-- doxytag: member="WAITFORIO" ref="gg1cbceddebd8723dff49458ce4045853f1e3a5237609db55456ad8b411e3b9f2c" args="" -->WAITFORIO</em>&nbsp;</td><td>
Block the requesting thread, until the device specified by <em>payload</em> completes its I/O operation. 
<p>
If the device does not exist, the thread and its progeny will be terminated. Return the STATUS register value of the device upon I/O completion. </td></tr>
</table>
</dl>

</div>
</div><p>
<a class="anchor" name="gac232a6efd6fe7eba766fd27c652b5cc"></a><!-- doxytag: member="kernel.h::SyscallMsg" ref="gac232a6efd6fe7eba766fd27c652b5cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__KIterface.html#gac232a6efd6fe7eba766fd27c652b5cc">SyscallMsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Syscall mnemonic values. 
<p>
<dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="ggac232a6efd6fe7eba766fd27c652b5cc67be7a5f47004345047b32fff72a2230"></a><!-- doxytag: member="SEND" ref="ggac232a6efd6fe7eba766fd27c652b5cc67be7a5f47004345047b32fff72a2230" args="" -->SEND</em>&nbsp;</td><td>
For message send. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="ggac232a6efd6fe7eba766fd27c652b5cc586011d90be069a5203e7bdbcb760302"></a><!-- doxytag: member="RECV" ref="ggac232a6efd6fe7eba766fd27c652b5cc586011d90be069a5203e7bdbcb760302" args="" -->RECV</em>&nbsp;</td><td>
For message receive. </td></tr>
</table>
</dl>

</div>
</div><p>
<a class="anchor" name="g570c4ee4b7e9b06de25acaad56cdb1e6"></a><!-- doxytag: member="kernel.h::TrapCommand" ref="g570c4ee4b7e9b06de25acaad56cdb1e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__KIterface.html#g570c4ee4b7e9b06de25acaad56cdb1e6">TrapCommand</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Commands for the SYSCALL/TLB/TRAP manager. 
<p>
After the trap handling the manager should send this message to the trapped thread in order to continue it or terminate it. <dl compact><dt><b>Enumerator: </b></dt><dd>
<table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" name="gg570c4ee4b7e9b06de25acaad56cdb1e6def07312c4771960b414a7978d978cef"></a><!-- doxytag: member="TRAPTERMINATE" ref="gg570c4ee4b7e9b06de25acaad56cdb1e6def07312c4771960b414a7978d978cef" args="" -->TRAPTERMINATE</em>&nbsp;</td><td>
Terminate the trapped thread. </td></tr>
<tr><td valign="top"><em><a class="anchor" name="gg570c4ee4b7e9b06de25acaad56cdb1e664b0325ae5a701a1c601d92c357ff52c"></a><!-- doxytag: member="TRAPCONTINUE" ref="gg570c4ee4b7e9b06de25acaad56cdb1e664b0325ae5a701a1c601d92c357ff52c" args="" -->TRAPCONTINUE</em>&nbsp;</td><td>
Continue the trapped thread. </td></tr>
</table>
</dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="g755e2ed4fdb9bfc9d54c5a28de5a94b6"></a><!-- doxytag: member="kernel.h::SSIRequest" ref="g755e2ed4fdb9bfc9d54c5a28de5a94b6" args="(unsigned service, unsigned payload, unsigned *reply)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SSIRequest           </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>payload</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&nbsp;</td>
          <td class="paramname"> <em>reply</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Perform a System Service request. 
<p>
This function sends a request to the System Service Thread and block the caller until the service is done. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>service</em>&nbsp;</td><td>The service to require (one of ServiceRequest enumeration). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>payload</em>&nbsp;</td><td>The (optional) parameter for the service. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>reply</em>&nbsp;</td><td>The (optional) service output parameter. </td></tr>
  </table>
</dl>
<dl class="see" compact><dt><b>See also:</b></dt><dd><a class="el" href="group__KIterface.html#g1cbceddebd8723dff49458ce4045853f">ServiceRequest</a> </dd></dl>

</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Tue Jul 3 01:52:03 2007 for Double A O.S. by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
